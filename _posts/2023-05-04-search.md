---
layout: post
title: "搜索业务中的经验总结"
date: 2023-05-04 11:09:11 -0800
categories: search
---

## 一些业内概念
- ctr和cqr
- tightness的两种概念
- omit
- proximity
- 召回策略的思路、手段

## 一些遇到的问题
#### query=title时排序不佳
#### 在线和离线分词是否该统一
#### 单维度排序怎么做
#### 姓名搜索怎么做
需求：单字、双字、全名、部分拼音、部分模糊字，都能搜到
#### 两次相同查询排序不同
这会导致两种badcase：1是用户搜完看到的结果顺序不同，2是用户在翻页/loadmore后看到有重复数据
给ES查询时带上with-preference是一种解决方案，但不完全，因为1会导致热点问题（可以通过preference=uid来解决），2还是会出乱序因为即使路由到同一个shard，这个shard可能在做update时也会不同顺序。
同时也要考虑dfs_query_then_fetch，这个配置能让一次search请求路由到其他分片，同时获得全局的tf-idf，来避免仅在本地数据计算分数时的局限性。
